# ATDD introduce collapse/expand on cards

Let's implement collapse/expand on cards for displaying or hiding detail text. When a card text collapse/expand state changes, this should be persisted and propagated to other users, to retain the basic idea of the whiteboard - everybody observes the same view all of the time.

```
scenario("Cards are displayed in text collapsed.", () => {
  given.userIsAuthenticated("alice");
  given.cardExists({ title: "Draft spec", column: "Todo", text: "Some text", expanded: false });
  then.swimlaneShowsCard("Draft spec", "In progress", show-hide-button-face: "Closed eye symbol");
});
```
```
scenario("Card text is expanded.", () => {
  given.userIsAuthenticated("alice");
  given.cardExists({ title: "Draft spec", column: "Todo", text: "Some text", expanded: false });
  then.swimlaneShowsCard("Draft spec", "In progress", show-hide-button-face: "Closed eye symbol");
  when.expandCardText({title: "Draft spec"});
  then.swimlaneShowsCard("Draft spec", "In progress", text: "Some text", show-hide-button-face: "Opened eye symbol");
  then.changeIsPersisted(); // and propagated to other users.
});
```

## chats response
Implemented collapse/expand state with persistence and UI controls:

Domain/API: Cards now carry expanded (default true); new updateExpanded service method and /api/cards/expanded endpoint. Create accepts optional expanded.
Tests: ATDD for collapsed/expanded behavior added (tests/atdd/expand.spec.ts), DSL supports expanded on cardExists, assertions on expanded, and actions to expand/collapse. Total tests now 17 passing.
UI: Text only renders when expanded is true; added an eye/closed-eye toggle per card that calls the new endpoint to persist and broadcast the state. Edit toggle still works separately.
Styling tweaks minor to support hidden blocks.
Tests: npm test (all passing). Rebuild/restart and you should see a new eye icon on cards to show/hide text, with the state shared across users.

5 files changed
+144
-6

Undo

View all changes
main.js
+33
-1

board.ts
+20
-1

server.ts
+34
-0

dsl.ts
+31
-4

expand.spec.ts
+26
-0

## flaw: the collapse/expand button should probably be places in line and before the edit button.

### chats response
Adjusted the button order so collapse/expand comes before edit:

In card view, the eye toggle now appears before the edit toggle in the inline controls (public/main.js).
Tests remain green (npm test: 17/17). Refresh/rebuild to see the updated button order.

1 file changed

Undo

View all changes
main.js
+8
-8

## flaw: collapse/expand and edit should be in a single row

### chats response
Collapse/expand and edit controls now sit together on a single row:

Grouped the eye toggle and edit toggle into a view-actions inline container in each card (public/main.js), with supporting styling (public/styles.css).
All tests still pass (npm test: 17/17). Refresh/rebuild to see the controls aligned on one row.

2 files changed
+13
-2

Undo

View all changes
main.js
+7
-2

styles.css
+6
-0
